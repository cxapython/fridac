---
alwaysApply: true
---
## fridac è‡ªå®šä¹‰è„šæœ¬ç³»ç»Ÿè§„èŒƒï¼ˆAlways Applyï¼‰

### æ ¸å¿ƒåŸåˆ™
- **è‡ªåŠ¨å‘ç°**: è‡ªåŠ¨æ‰«æ [scripts/](mdc:fridac/scripts/) ç›®å½•ä¸‹çš„ `.js` æ–‡ä»¶
- **é›¶é…ç½®**: åˆ›å»ºè„šæœ¬å³å¯ä½¿ç”¨ï¼Œæ— éœ€é¢å¤–é…ç½®
- **å®Œå…¨é›†æˆ**: äº«å—ä¸å†…ç½®å‡½æ•°ç›¸åŒçš„ä½“éªŒï¼ˆTabè¡¥å…¨ã€Helpã€ä»»åŠ¡ç®¡ç†ï¼‰
- **çƒ­é‡è½½**: ä½¿ç”¨ `reload_scripts` å‘½ä»¤å®ç°è¿è¡Œæ—¶é‡æ–°åŠ è½½

### è„šæœ¬ç¼–å†™è§„èŒƒ

#### JSDoc æ³¨é‡Šæ ¼å¼ï¼ˆå¿…éœ€ï¼‰
```javascript
/**
 * å‡½æ•°ç®€çŸ­æè¿°ï¼ˆå¿…éœ€ï¼‰
 * @description è¯¦ç»†æè¿°ï¼ˆæ¨èï¼‰
 * @example functionName(param1, param2)ï¼ˆæ¨èï¼‰
 * @param {type} paramName - å‚æ•°æè¿°ï¼ˆå¯é€‰ï¼‰
 * @author ä½œè€…åï¼ˆå¯é€‰ï¼‰
 */
function functionName(param1, param2) {
    // å®ç°
}
```

#### æœ€ä½³å®è·µ
- **é”™è¯¯å¤„ç†**: ä½¿ç”¨ `try-catch` åŒ…è£…ä¸»è¦é€»è¾‘
- **ä»»åŠ¡é›†æˆ**: ä½¿ç”¨ `notifyTaskHit()`ã€`notifyTaskError()` ä¸ä»»åŠ¡ç³»ç»Ÿé›†æˆ
- **æ—¥å¿—è¾“å‡º**: ä½¿ç”¨ `LOG(message, { c: Color.* })` è¿›è¡Œæ—¥å¿—è¾“å‡º
- **è°ƒç”¨æ ˆ**: ä½¿ç”¨ `printStack()` æ˜¾ç¤ºè°ƒç”¨æ ˆ
- **å‚æ•°éªŒè¯**: éªŒè¯å’Œè®¾ç½®é»˜è®¤å‚æ•°å€¼

#### å†…ç½®å·¥å…·å‡½æ•°
```javascript
// æ—¥å¿—è¾“å‡º
LOG("æ¶ˆæ¯", { c: Color.Green });

// è°ƒç”¨æ ˆ
printStack();

// ä»»åŠ¡é€šçŸ¥
notifyTaskHit({ operation: "my_operation", data: "some_data" });
notifyTaskError(error);

// é¢œè‰²å¸¸é‡
Color.Red, Color.Green, Color.Blue, Color.Yellow, Color.Cyan, Color.White, Color.Gray

// ä»»åŠ¡IDæ£€æµ‹
if (typeof TASK_ID !== 'undefined') {
    // åœ¨ä»»åŠ¡æ¨¡å¼ä¸‹æ‰§è¡Œ
}
```

### ç³»ç»Ÿé›†æˆ

#### è‡ªåŠ¨åŠ è½½æµç¨‹
1. **æ‰«æé˜¶æ®µ**: [CustomScriptManager](mdc:fridac/fridac_core/custom_scripts.py) æ‰«æ `scripts/` ç›®å½•
2. **è§£æé˜¶æ®µ**: ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è§£æå‡½æ•°å®šä¹‰å’Œ JSDoc æ³¨é‡Š
3. **é›†æˆé˜¶æ®µ**: å°†è„šæœ¬å†…å®¹å’Œ RPC å¯¼å‡ºé›†æˆåˆ°ä¸»è„šæœ¬
4. **è¡¥å…¨æ³¨å†Œ**: è‡ªåŠ¨å°†è‡ªå®šä¹‰å‡½æ•°æ·»åŠ åˆ° Tab è¡¥å…¨ç³»ç»Ÿ

#### ä»»åŠ¡ç®¡ç†é›†æˆ
- è‡ªå®šä¹‰å‡½æ•°è‡ªåŠ¨æ”¯æŒä»»åŠ¡ç®¡ç†ç³»ç»Ÿ
- æ¯ä¸ªå‡½æ•°è°ƒç”¨åˆ›å»ºç‹¬ç«‹çš„ä»»åŠ¡ (`TaskType.CUSTOM_HOOK`)
- æ”¯æŒ `tasks`ã€`kill`ã€`killall` ç­‰ä»»åŠ¡ç®¡ç†å‘½ä»¤
- ä»»åŠ¡è¾“å‡ºå¸¦ `[#ä»»åŠ¡ID]` å‰ç¼€

#### Tab è¡¥å…¨é›†æˆ
- è‡ªå®šä¹‰å‡½æ•°è‡ªåŠ¨åŠ å…¥ [completer.py](mdc:fridac/fridac_core/completer.py)
- æ˜¾ç¤ºæ ¼å¼: `ğŸ”§ è‡ªå®šä¹‰: å‡½æ•°æè¿°`
- æ”¯æŒ `reload_scripts` ååŠ¨æ€æ›´æ–°è¡¥å…¨åˆ—è¡¨

#### Help ç³»ç»Ÿé›†æˆ
- åœ¨ `help()` è¾“å‡ºä¸­æ˜¾ç¤ºè‡ªå®šä¹‰å‡½æ•°
- æ˜¾ç¤ºå‡½æ•°æè¿°å’Œä½¿ç”¨ç¤ºä¾‹
- æŒ‰ç±»åˆ«åˆ†ç»„æ˜¾ç¤º

### å¼€å‘å·¥ä½œæµ

#### åˆ›å»ºæ–°è„šæœ¬
1. åœ¨ `scripts/` ç›®å½•åˆ›å»º `.js` æ–‡ä»¶
2. ä½¿ç”¨ JSDoc æ ¼å¼ç¼–å†™å‡½æ•°
3. åœ¨ fridac ä¸­è°ƒç”¨ `reload_scripts` æˆ–é‡å¯

#### è°ƒè¯•è„šæœ¬
```bash
# é‡æ–°åŠ è½½è„šæœ¬
fridac> reload_scripts

# æµ‹è¯•å‡½æ•°å­˜åœ¨
fridac> typeof myFunction

# æŸ¥çœ‹å‡½æ•°å®šä¹‰
fridac> myFunction.toString().substring(0, 100)

# æ‰§è¡Œå‡½æ•°
fridac> myFunction(arg1, arg2)

# æŸ¥çœ‹ä»»åŠ¡çŠ¶æ€
fridac> tasks
```

#### é”™è¯¯å¤„ç†
- è¯­æ³•é”™è¯¯ä¼šè·³è¿‡è¯¥è„šæœ¬å¹¶ç»§ç»­åŠ è½½å…¶ä»–è„šæœ¬
- è¿è¡Œæ—¶é”™è¯¯ä¼šè®°å½•åˆ°æ—¥å¿—ï¼Œä¸å½±å“å…¶ä»–åŠŸèƒ½
- ä½¿ç”¨ `log_debug` æŸ¥çœ‹è¯¦ç»†çš„åŠ è½½è¿‡ç¨‹

### æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

#### [custom_scripts.py](mdc:fridac/fridac_core/custom_scripts.py)
- `CustomScriptManager`: ä¸»ç®¡ç†ç±»
- `CustomFunction`: å‡½æ•°ä¿¡æ¯æ•°æ®ç±»
- `scan_scripts()`: æ‰«æè„šæœ¬ç›®å½•
- `generate_script_imports()`: ç”Ÿæˆå¯¼å…¥ä»£ç 
- `generate_rpc_exports()`: ç”Ÿæˆ RPC å¯¼å‡º

#### é›†æˆç‚¹
- [script_manager.py](mdc:fridac/fridac_core/script_manager.py): `_load_custom_scripts()`
- [session.py](mdc:fridac/fridac_core/session.py): `_handle_custom_function_command()`
- [completer.py](mdc:fridac/fridac_core/completer.py): `_load_custom_functions()`
- [script_templates.py](mdc:fridac/fridac_core/script_templates.py): `generate_custom_script()`

### ç¤ºä¾‹è„šæœ¬å‚è€ƒ
- [crypto_detector.js](mdc:fridac/scripts/crypto_detector.js): åŠ å¯†æ£€æµ‹å·¥å…·é›†
- [network_monitor.js](mdc:fridac/scripts/network_monitor.js): ç½‘ç»œç›‘æ§å·¥å…·é›†
- [CUSTOM_SCRIPTS_GUIDE.md](mdc:fridac/CUSTOM_SCRIPTS_GUIDE.md): å®Œæ•´å¼€å‘æŒ‡å—