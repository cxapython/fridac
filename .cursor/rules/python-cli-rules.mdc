---
globs: fridac,*.py
description: Python CLI开发规范和fridac特定要求
---

# Python CLI 开发规范

## fridac特定要求

### Python版本兼容性
- **最低版本**: Python 3.6.8
- **f-strings**: 可以使用，Python 3.6+支持
- **类型注解**: 避免使用复杂的类型注解，保持向下兼容
- **新特性**: 避免使用Python 3.7+的新功能

### 依赖管理
主要依赖在 [requirements.txt](mdc:requirements.txt) 中定义：
```
frida>=14.0.0
rich>=10.0.0  # 可选，用于美化界面
```

### Rich库使用规范
- Rich库是可选依赖，必须优雅降级
- 使用try-except包装所有Rich导入
- 提供基础模式作为备选方案

```python
try:
    from rich.console import Console
    from rich.table import Table
    RICH_AVAILABLE = True
except ImportError:
    RICH_AVAILABLE = False
```

## 代码结构规范

### 函数定义
- 使用清晰的中文注释
- 函数名使用英文，注释使用中文
- 包含完整的错误处理

### 日志系统
使用项目统一的日志函数：
```python
def log_info(message):
def log_success(message):  
def log_warning(message):
def log_error(message):
def log_debug(message):
```

### 自动补全系统
FridacCompleter类负责：
- Tab补全功能
- 函数帮助显示
- 参数提示
- 历史记录管理

### RPC导出规范
所有JavaScript函数必须在rpc.exports中定义：
```python
rpc.exports = {
    'functionName': typeof functionName !== 'undefined' ? functionName : fallbackFunction
}
```

## 错误处理

### 文件操作
- 检查JavaScript文件是否存在
- 提供清晰的错误提示
- 自动查找文件路径

### Frida连接
- 处理设备连接失败
- 处理应用启动/附加失败  
- 提供重试机制

### 用户输入
- 验证用户输入的有效性
- 处理特殊字符和转义
- 提供输入提示和帮助