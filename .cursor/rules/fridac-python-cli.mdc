---
description: Python CLI开发规范和fridac特定要求
globs: *.py
---
# fridac Python CLI 规则

- 兼容性：最低 Python 3.6.8（推荐 3.8），避免使用 3.7+ 专属特性
- Rich 为可选依赖：所有导入使用 try/except，缺失时优雅降级
- 日志 API（统一使用）：在 [logger.py](mdc:fridac_core/logger.py) 中的 `log_info/log_success/log_warning/log_error/log_debug`
- 交互：使用 readline 开启 Tab 补全；macOS(libedit) 与 GNU 兼容绑定（见 [session.py](mdc:fridac_core/session.py) 的 `setup_history`）
- 任务系统：新增 Hook 功能必须走 [task_manager.py](mdc:fridac_core/task_manager.py) 与 [script_templates.py](mdc:fridac_core/script_templates.py)
- JS 交互：通过 RPC `eval` 或专用导出函数；长代码前先 `log_debug` 截断显示
- 退出与清理：调用 `script.unload()`，`detach()`，并通过 `task_manager.cleanup()` 做收尾

