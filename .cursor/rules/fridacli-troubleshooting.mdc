---
description: fridacliå¸¸è§é—®é¢˜æ’æŸ¥å’Œè§£å†³æ–¹æ¡ˆæŒ‡å—
---

# fridacli æ•…éšœæ’æŸ¥æŒ‡å—

## å¸¸è§é—®é¢˜åˆ†ç±»

### 1. ä»»åŠ¡ç®¡ç†ç›¸å…³é—®é¢˜

#### é—®é¢˜ï¼šæ‰§è¡ŒHookå‡½æ•°åjobs()æŸ¥ä¸åˆ°ä»»åŠ¡
**ç—‡çŠ¶**ï¼š
```javascript
fridac> hookLog()
âœ… Log Hookå·²å¯ç”¨
fridac> jobs()
ğŸ“‹ æ²¡æœ‰æ‰¾åˆ°ä»»åŠ¡
```

**åŸå› åˆ†æ**ï¼š
- ä»»åŠ¡ç®¡ç†ç³»ç»Ÿæœªæ­£ç¡®åˆå§‹åŒ–
- Hookå‡½æ•°æœªé›†æˆè‡ªåŠ¨ä»»åŠ¡æ³¨å†Œ
- RPCå¯¼å‡ºé…ç½®é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**ï¼š
```javascript
// 1. æ£€æŸ¥ä»»åŠ¡ç®¡ç†å™¨æ˜¯å¦å¯ç”¨
if (typeof HookJobManager !== 'undefined') {
    console.log("ä»»åŠ¡ç®¡ç†å™¨å¯ç”¨");
} else {
    console.log("ä»»åŠ¡ç®¡ç†å™¨æœªåŠ è½½");
}

// 2. æ£€æŸ¥Hookå‡½æ•°æ˜¯å¦æ­£ç¡®é›†æˆ
// ç¡®ä¿Hookå‡½æ•°åŒ…å«ä»¥ä¸‹ä»£ç ï¼š
var taskId = null;
if (typeof HookJobManager !== 'undefined') {
    taskId = HookJobManager.autoRegisterHook('hookLog', [showStack]);
}

// 3. æ£€æŸ¥RPCå¯¼å‡º
// åœ¨fridacä¸»ç¨‹åºä¸­ç¡®ä¿æ­£ç¡®å¯¼å‡ºjobså‡½æ•°
```

#### é—®é¢˜ï¼šä»»åŠ¡çŠ¶æ€ä¸æ­£ç¡®æ›´æ–°
**ç—‡çŠ¶**ï¼šä»»åŠ¡ä¸€ç›´æ˜¾ç¤ºä¸ºpendingçŠ¶æ€

**è§£å†³æ–¹æ¡ˆ**ï¼š
```javascript
// ç¡®ä¿Hookå‡½æ•°ä¸­åŒ…å«çŠ¶æ€æ›´æ–°é€»è¾‘
if (taskId && typeof HookJobManager !== 'undefined') {
    var job = HookJobManager.getJob(taskId);
    if (job) {
        job.updateStatus('active');
    }
}
```

### 2. HookåŠŸèƒ½é—®é¢˜

#### é—®é¢˜ï¼šClassNotFoundException
**ç—‡çŠ¶**ï¼š
```javascript
âŒ ç±» 'com.example.MainActivity' æœªåœ¨é»˜è®¤ClassLoaderä¸­æ‰¾åˆ°
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```javascript
// 1. ä½¿ç”¨æ™ºèƒ½ClassLoaderæŸ¥æ‰¾
var customLoader = findTargetClassLoaderForClass(className);
if (customLoader) {
    var targetClass = Java.ClassFactory.get(customLoader).use(className);
}

// 2. æ£€æŸ¥ç±»åæ˜¯å¦æ­£ç¡®
// - ç¡®ä¿åŒ…åæ‹¼å†™æ­£ç¡®
// - ç¡®è®¤ç±»ç¡®å®å­˜åœ¨äºåº”ç”¨ä¸­
// - å°è¯•ä½¿ç”¨findClasses()æœç´¢ç±»

// 3. ç­‰å¾…ç±»åŠ è½½å®Œæˆ
// æŸäº›ç±»å¯èƒ½éœ€è¦è§¦å‘ç‰¹å®šæ¡ä»¶æ‰ä¼šåŠ è½½
```

#### é—®é¢˜ï¼šHookä¸ç”Ÿæ•ˆ
**ç—‡çŠ¶**ï¼šHookè®¾ç½®æˆåŠŸä½†æ²¡æœ‰è¾“å‡º

**è§£å†³æ–¹æ¡ˆ**ï¼š
```javascript
// 1. æ£€æŸ¥æ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨
// - ç¡®è®¤åº”ç”¨ç¡®å®è°ƒç”¨äº†è¯¥æ–¹æ³•
// - æ£€æŸ¥æ–¹æ³•ç­¾åæ˜¯å¦æ­£ç¡®
// - ä½¿ç”¨overload()æŒ‡å®šæ­£ç¡®çš„é‡è½½ç‰ˆæœ¬

// 2. æ£€æŸ¥Hookå®ç°
hookTarget.methodName.implementation = function() {
    console.log("Hookè§¦å‘"); // æ·»åŠ è°ƒè¯•è¾“å‡º
    return this.methodName.apply(this, arguments);
};

// 3. æ£€æŸ¥ä»»åŠ¡çŠ¶æ€
job(taskId); // æŸ¥çœ‹ä»»åŠ¡è¯¦æƒ…å’Œé”™è¯¯ä¿¡æ¯
```

### 3. ç¯å¢ƒé…ç½®é—®é¢˜

#### é—®é¢˜ï¼šRichåº“å¯¼å…¥å¤±è´¥
**ç—‡çŠ¶**ï¼š
```
ImportError: No module named 'rich'
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. å®‰è£…Richåº“
pip install rich>=10.0.0

# 2. æˆ–è€…ä½¿ç”¨åŸºç¡€æ¨¡å¼
# fridacä¼šè‡ªåŠ¨é™çº§åˆ°åŸºç¡€ç•Œé¢æ¨¡å¼
# ä¸å½±å“æ ¸å¿ƒåŠŸèƒ½ä½¿ç”¨

# 3. æ£€æŸ¥Pythonç¯å¢ƒ
python3 -c "import rich; print(rich.__version__)"
```

#### é—®é¢˜ï¼šFridaç‰ˆæœ¬ä¸å…¼å®¹
**ç—‡çŠ¶**ï¼š
```
frida.InvalidArgumentError: script not found
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. æ£€æŸ¥Fridaç‰ˆæœ¬
frida --version
python3 -c "import frida; print(frida.__version__)"

# 2. å‡çº§åˆ°æ”¯æŒç‰ˆæœ¬
pip install frida>=14.0.0

# 3. æ£€æŸ¥è®¾å¤‡è¿æ¥
frida-ps -U
```

### 4. æ–‡ä»¶è·¯å¾„é—®é¢˜

#### é—®é¢˜ï¼šæ‰¾ä¸åˆ°Hookå·¥å…·æ–‡ä»¶
**ç—‡çŠ¶**ï¼š
```
âŒ æ‰¾ä¸åˆ° frida_common.js æ–‡ä»¶
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. æ£€æŸ¥æ–‡ä»¶å­˜åœ¨
ls -la frida_*.js

# 2. ç¡®ä¿æ–‡ä»¶åœ¨æ­£ç¡®è·¯å¾„
# fridacä¼šåœ¨ä»¥ä¸‹è·¯å¾„æŸ¥æ‰¾ï¼š
# - å½“å‰ç›®å½•
# - fridacç¨‹åºæ‰€åœ¨ç›®å½•  
# - ~/fridaproject/
# - /usr/local/bin/

# 3. å¤åˆ¶åˆ°ç³»ç»Ÿè·¯å¾„
sudo cp frida_*.js /usr/local/bin/
```

### 5. æƒé™é—®é¢˜

#### é—®é¢˜ï¼šæ— æ³•æ‰§è¡Œfridac
**ç—‡çŠ¶**ï¼š
```bash
bash: fridac: Permission denied
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. æ·»åŠ æ‰§è¡Œæƒé™
chmod +x fridac

# 2. æ£€æŸ¥æ–‡ä»¶æ‰€æœ‰è€…
ls -la fridac
sudo chown $USER:$USER fridac

# 3. å…¨å±€å®‰è£…æ—¶çš„æƒé™
sudo cp fridac /usr/local/bin/fridac
sudo chmod +x /usr/local/bin/fridac
```

## è°ƒè¯•æŠ€å·§

### 1. ä»»åŠ¡ç®¡ç†è°ƒè¯•
```javascript
// æŸ¥çœ‹ä»»åŠ¡ç®¡ç†å™¨çŠ¶æ€
console.log("HookJobManager:", typeof HookJobManager);
console.log("activeJobs:", HookJobManager ? HookJobManager.getActiveJobs().length : 0);

// æŸ¥çœ‹å…·ä½“ä»»åŠ¡ä¿¡æ¯
job(1); // æŸ¥çœ‹ä»»åŠ¡#1çš„è¯¦ç»†ä¿¡æ¯

// æŸ¥çœ‹ç³»ç»Ÿç»Ÿè®¡
jobstats(); // æ˜¾ç¤ºå®Œæ•´çš„ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯
```

### 2. Hookè°ƒè¯•
```javascript
// åœ¨Hookå‡½æ•°ä¸­æ·»åŠ è°ƒè¯•è¾“å‡º
hookTarget.methodName.implementation = function() {
    console.log("=== Hook Debug Info ===");
    console.log("æ–¹æ³•è¢«è°ƒç”¨:", arguments.length, "ä¸ªå‚æ•°");
    console.log("è°ƒç”¨æ ˆ:", Java.use("android.util.Log").getStackTraceString(
        Java.use("java.lang.Exception").$new()
    ));
    
    var result = this.methodName.apply(this, arguments);
    console.log("è¿”å›å€¼:", result);
    return result;
};
```

### 3. æ€§èƒ½è°ƒè¯•
```javascript
// ç›‘æ§ä»»åŠ¡æ€§èƒ½
setInterval(function() {
    console.log("æ´»è·ƒä»»åŠ¡æ•°:", HookJobManager.getActiveJobs().length);
    console.log("å†…å­˜ä½¿ç”¨:", Process.getCurrentRss());
}, 5000);

// æ£€æŸ¥Hookå‘½ä¸­é¢‘ç‡
job(taskId); // æŸ¥çœ‹hitCountå’ŒavgTime
```

## é¢„é˜²æªæ–½

### 1. å¼€å‘æ—¶çš„æœ€ä½³å®è·µ
```javascript
// 1. æ€»æ˜¯åŒ…å«é”™è¯¯å¤„ç†
try {
    // Hooké€»è¾‘
} catch (e) {
    LOG("Hookå¤±è´¥: " + e.message, { c: Color.Red });
    // æ›´æ–°ä»»åŠ¡çŠ¶æ€
}

// 2. éªŒè¯å¯¹è±¡å­˜åœ¨æ€§
if (typeof targetObject !== 'undefined') {
    // ä½¿ç”¨targetObject
}

// 3. ä½¿ç”¨æ¸è¿›å¼Hook
// å…ˆHookç®€å•æ–¹æ³•éªŒè¯ç¯å¢ƒï¼Œå†Hookå¤æ‚é€»è¾‘
```

### 2. éƒ¨ç½²æ—¶çš„æ£€æŸ¥æ¸…å•
```bash
# æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥
- [ ] fridacä¸»ç¨‹åºå­˜åœ¨ä¸”å¯æ‰§è¡Œ
- [ ] æ‰€æœ‰frida_*.jsæ–‡ä»¶å­˜åœ¨
- [ ] requirements.txtä¸­çš„ä¾èµ–å·²å®‰è£…

# ç¯å¢ƒå…¼å®¹æ€§æ£€æŸ¥  
- [ ] Python 3.6.8+
- [ ] Frida 14.0.0+
- [ ] è®¾å¤‡è¿æ¥æ­£å¸¸

# åŠŸèƒ½éªŒè¯æ£€æŸ¥
- [ ] åŸºç¡€HookåŠŸèƒ½æ­£å¸¸
- [ ] ä»»åŠ¡ç®¡ç†åŠŸèƒ½æ­£å¸¸
- [ ] è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½æ­£å¸¸
```

### 3. ç”¨æˆ·ä½¿ç”¨æŒ‡å¯¼
```javascript
// å»ºè®®çš„ä½¿ç”¨æµç¨‹
1. fridac                    // è¿æ¥åº”ç”¨
2. help()                   // æŸ¥çœ‹å¯ç”¨å‡½æ•°
3. hookLog()                // æµ‹è¯•åŸºç¡€Hook
4. jobs()                   // éªŒè¯ä»»åŠ¡ç®¡ç†
5. smartTrace('ç›®æ ‡')        // å¼€å§‹æ™ºèƒ½åˆ†æ
```

## å‡çº§å’Œè¿ç§»

### ç‰ˆæœ¬å‡çº§æ³¨æ„äº‹é¡¹
```bash
# 1. å¤‡ä»½ç°æœ‰é…ç½®
cp ~/.fridac_history ~/.fridac_history.bak

# 2. æ£€æŸ¥APIå˜æ›´
# æŸ¥çœ‹CHANGELOGäº†è§£breaking changes

# 3. æ¸è¿›å¼å‡çº§
# å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ï¼Œå†éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
```

### é…ç½®è¿ç§»
```bash
# 1. ä¿æŒé…ç½®æ–‡ä»¶å…¼å®¹
# ~/.fridac_history - å‘½ä»¤å†å²
# é¡¹ç›®ä¸­çš„frida_*.jsæ–‡ä»¶

# 2. æ£€æŸ¥è‡ªå®šä¹‰Hookå‡½æ•°
# ç¡®ä¿ç¬¦åˆæ–°çš„ä»»åŠ¡ç®¡ç†è§„èŒƒ

# 3. æ›´æ–°æ–‡æ¡£å¼•ç”¨
# æ›´æ–°é¡¹ç›®æ–‡æ¡£ä¸­çš„å‡½æ•°è°ƒç”¨ç¤ºä¾‹
```

## è·å–å¸®åŠ©

### å†…ç½®å¸®åŠ©ç³»ç»Ÿ
```javascript
help()      // å®Œæ•´å‡½æ•°åˆ—è¡¨
jobhelp()   // ä»»åŠ¡ç®¡ç†å¸®åŠ©
```

### è°ƒè¯•ä¿¡æ¯æ”¶é›†
å½“éœ€è¦æŠ¥å‘Šé—®é¢˜æ—¶ï¼Œè¯·æ”¶é›†ä»¥ä¸‹ä¿¡æ¯ï¼š
```bash
# 1. ç¯å¢ƒä¿¡æ¯
python3 --version
frida --version
fridac --version

# 2. é”™è¯¯æ—¥å¿—
# å®Œæ•´çš„é”™è¯¯è¾“å‡ºå’Œè°ƒç”¨æ ˆ

# 3. å¤ç°æ­¥éª¤
# è¯¦ç»†çš„æ“ä½œæ­¥éª¤å’Œé¢„æœŸç»“æœ

# 4. ç³»ç»Ÿä¿¡æ¯
uname -a        # ç³»ç»Ÿç‰ˆæœ¬
adb devices     # è®¾å¤‡è¿æ¥çŠ¶æ€
```